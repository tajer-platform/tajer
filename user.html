<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªÙ€Ø§Ø¬Ø± Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠ | Ù…Ù†ØµØ© Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± Ø§Ù„Ø°ÙƒÙŠØ©</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #10b981;
            --primary-dark: #059669;
            --secondary: #3b82f6;
            --accent: #f59e0b;
            --bg-body: #f8fafc;
            --white: #ffffff;
            --text-main: #1e293b;
            --glass: rgba(255, 255, 255, 0.9);
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Tajawal', sans-serif; }

        body {
            background-color: var(--bg-body);
            color: var(--text-main);
            padding-bottom: 80px; /* Ù…Ø³Ø§Ø­Ø© Ù„Ù„Ù€ Navbar Ø§Ù„Ø³ÙÙ„ÙŠ */
            line-height: 1.6;
        }

        /* --- Header --- */
        .top-bar {
            background: linear-gradient(135deg, #064e3b 0%, #10b981 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 0 0 30px 30px;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo { display: flex; align-items: center; gap: 10px; font-size: 1.4rem; font-weight: 800; }
        .logo i { color: #a7f3d0; font-size: 1.8rem; }
        .logo span span { color: #a7f3d0; }

        .user-stats { display: flex; align-items: center; gap: 15px; }
        .balance-box { text-align: left; }
        .balance-box small { font-size: 0.75rem; opacity: 0.8; display: block; }
        .balance-box .val { font-size: 1.2rem; font-weight: 700; color: #fff; }
        .user-img { width: 45px; height: 45px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.3); object-fit: cover; }

        /* --- Quick Actions --- */
        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            padding: 20px;
            margin-top: -20px;
        }
        .btn-action {
            background: var(--white);
            border: none;
            padding: 15px;
            border-radius: 20px;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: 0.3s;
            color: var(--text-main);
        }
        .btn-action.deposit { color: var(--primary-dark); }
        .btn-action.withdraw { color: var(--secondary); }
        .btn-action:active { transform: scale(0.95); }

        /* --- Stats Cards --- */
        .dashboard-summary {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            padding: 0 20px;
        }
        .stat-card {
            background: var(--white);
            padding: 20px;
            border-radius: 24px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
            position: relative;
            overflow: hidden;
        }
        .stat-card i {
            position: absolute;
            left: -10px;
            bottom: -10px;
            font-size: 3rem;
            color: var(--primary);
            opacity: 0.1;
        }
        .stat-card small { color: #64748b; font-size: 0.8rem; display: block; margin-bottom: 5px; }
        .stat-card h3 { font-size: 1.3rem; font-weight: 800; }
        .profit { color: var(--primary-dark); }

        /* --- Sections Control --- */
        .page { display: none; padding: 20px; animation: slideIn 0.4s ease-out; }
        .page.active { display: block; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        h2.section-title { font-size: 1.5rem; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        h2.section-title::after { content: ''; flex: 1; height: 2px; background: #e2e8f0; }

        /* --- Market Grid --- */
        .market-grid { display: grid; grid-template-columns: 1fr; gap: 20px; }
        .market-item {
            background: var(--white);
            border-radius: 25px;
            padding: 20px;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            gap: 15px;
            position: relative;
            border: 1px solid #f1f5f9;
        }
        .market-item .badge {
            position: absolute; top: 15px; left: 15px;
            background: #dcfce7; color: var(--primary-dark);
            padding: 5px 12px; border-radius: 12px; font-weight: 700; font-size: 0.8rem;
        }
        .market-info h4 { font-size: 1.2rem; }
        .market-price { font-size: 1.5rem; font-weight: 800; color: var(--text-main); }
        .market-price span { font-size: 0.9rem; color: #94a3b8; }
        .btn-buy {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: 0.3s;
        }
        .btn-buy:hover { background: var(--primary-dark); }

        /* --- Bottom Nav --- */
        .bottom-nav {
            position: fixed;
            bottom: 0; left: 0; right: 0;
            background: var(--glass);
            backdrop-filter: blur(15px);
            display: flex;
            justify-content: space-around;
            padding: 15px 10px;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.05);
            border-radius: 25px 25px 0 0;
            z-index: 1000;
        }
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            color: #94a3b8;
            cursor: pointer;
            transition: 0.3s;
            flex: 1;
        }
        .nav-item i { font-size: 1.4rem; }
        .nav-item span { font-size: 0.75rem; font-weight: 600; }
        .nav-item.active { color: var(--primary); transform: translateY(-5px); }

        /* --- Support Chat UI --- */
        .chat-container {
            background: white;
            height: 400px;
            border-radius: 25px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: var(--shadow);
        }
        #chat-box { flex: 1; padding: 20px; overflow-y: auto; background: #f8fafc; }
        .chat-input-area { padding: 15px; display: flex; gap: 10px; background: white; border-top: 1px solid #eee; }
        .chat-input-area input { flex: 1; border: 1px solid #e2e8f0; padding: 12px; border-radius: 15px; outline: none; }
        .chat-input-area button { background: var(--primary); color: white; border: none; width: 45px; border-radius: 12px; }

        /* --- Toast Notification --- */
        #toast {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            background: #1e293b; color: white; padding: 12px 25px;
            border-radius: 50px; display: none; z-index: 2000; box-shadow: var(--shadow);
        }
    </style>
</head>
<body>

<div id="toast"></div>

<header class="top-bar">
    <div class="logo">
        <i class="fas fa-seedling"></i>
        <span>ØªÙ€Ø§Ø¬Ø± <span>Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠ</span></span>
    </div>
    <div class="user-stats">
        <div class="balance-box">
            <small>Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­</small>
            <div class="val"><span id="wallet-display">0</span> Ù„.Ø³</div>
        </div>
        <img src="https://ui-avatars.com/api/?name=User&background=10b981&color=fff" alt="Profile" class="user-img">
    </div>
</header>

<div class="action-buttons">
    <button class="btn-action deposit" onclick="tab('wallet')"><i class="fas fa-arrow-down"></i> Ø¥ÙŠØ¯Ø§Ø¹</button>
    <button class="btn-action withdraw" onclick="tab('wallet')"><i class="fas fa-arrow-up"></i> Ø³Ø­Ø¨</button>
</div>

<main id="main-content">

    <section id="home" class="page active">
        <div class="dashboard-summary">
            <div class="stat-card">
                <i class="fas fa-wallet"></i>
                <small>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙˆÙ„</small>
                <h3 id="total-assets-val">0</h3>
            </div>
            <div class="stat-card">
                <i class="fas fa-chart-line"></i>
                <small>Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ…</small>
                <h3 class="profit" id="today-profit">+0</h3>
            </div>
            <div class="stat-card">
                <i class="fas fa-cow"></i>
                <small>Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ù‡Ù…</small>
                <h3 id="assets-count">0</h3>
            </div>
            <div class="stat-card">
                <i class="fas fa-clock"></i>
                <small>Ø­Ø§Ù„Ø© Ø§Ù„Ø³ÙˆÙ‚</small>
                <h3 style="color:var(--primary)">Ù…ÙØªÙˆØ­</h3>
            </div>
        </div>
        
        <div style="padding: 20px;">
            <div style="background: linear-gradient(135deg, #1e293b 0%, #334155 100%); padding: 25px; border-radius: 25px; color: white; position: relative;">
                <h4 style="font-size: 1.2rem; margin-bottom: 10px;">Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ğŸ“¢</h4>
                <p style="font-size: 0.9rem; opacity: 0.8;">ØªÙ… Ø§Ù„Ø¨Ø¯Ø¡ Ø¨ØªÙˆØ²ÙŠØ¹ Ø£Ø±Ø¨Ø§Ø­ Ù…ÙˆØ³Ù… Ø§Ù„Ù‚Ù…Ø­ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³Ø§Ù‡Ù…ÙŠÙ†. ØªÙÙ‚Ø¯ Ù…Ø­ÙØ¸ØªÙƒ Ø§Ù„Ø¢Ù†!</p>
                <i class="fas fa-bullhorn" style="position: absolute; left: 20px; bottom: 20px; font-size: 2rem; opacity: 0.2;"></i>
            </div>
        </div>
    </section>

    <section id="market" class="page">
        <h2 class="section-title"><i class="fas fa-store" style="color:var(--primary)"></i> Ø³ÙˆÙ‚ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±</h2>
        <div id="market-grid" class="market-grid">
            </div>
    </section>

    <section id="assets" class="page">
        <h2 class="section-title"><i class="fas fa-briefcase" style="color:var(--secondary)"></i> Ù…Ø­ÙØ¸ØªÙŠ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ©</h2>
        <div id="my-assets-list" class="market-grid">
             <div style="text-align: center; padding: 40px; color: #94a3b8;">
                <i class="fas fa-folder-open" style="font-size: 3rem; margin-bottom: 10px;"></i>
                <p>Ù„Ø§ ØªÙ…ØªÙ„Ùƒ Ø£ÙŠ Ø£ØµÙˆÙ„ Ø­Ø§Ù„ÙŠØ§Ù‹</p>
             </div>
        </div>
    </section>

    <section id="community" class="page">
        <h2 class="section-title"><i class="fas fa-headset" style="color:var(--accent)"></i> Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</h2>
        <div class="chat-container">
            <div id="chat-box">
                <div style="background: #eef2ff; padding: 15px; border-radius: 15px; margin-bottom: 10px; font-size: 0.9rem; color: #4338ca;">
                    ğŸ‘‹ Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ! ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ… ÙÙŠ Ø§Ø³ØªØ«Ù…Ø§Ø±Ø§ØªÙƒØŸ
                </div>
            </div>
            <div class="chat-input-area">
                <input type="text" id="chat-in" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ...">
                <button onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
    </section>

    <section id="wallet" class="page">
        <h2 class="section-title"><i class="fas fa-wallet" style="color:var(--primary)"></i> Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©</h2>
        <div class="stat-card" style="margin-bottom: 20px; text-align: center;">
            <small>Ø±ØµÙŠØ¯Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ</small>
            <h2 style="font-size: 2rem; color: var(--primary)" id="wallet-large">0</h2>
        </div>
        
        <div class="market-item">
            <h4 style="margin-bottom: 15px;">Ø·Ù„Ø¨ Ø¹Ù…Ù„ÙŠØ© Ù…Ø§Ù„ÙŠØ©</h4>
            <input type="number" id="amount-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº (Ù„.Ø³)..." style="width: 100%; padding: 15px; border-radius: 15px; border: 1px solid #e2e8f0; margin-bottom: 15px;">
            <div style="display: flex; gap: 10px;">
                <button class="btn-buy" style="flex:1; background: var(--primary);" onclick="handleFinance('deposit')">Ø¥ÙŠØ¯Ø§Ø¹</button>
                <button class="btn-buy" style="flex:1; background: var(--text-main);" onclick="handleFinance('withdraw')">Ø³Ø­Ø¨</button>
            </div>
        </div>
    </section>

</main>

<nav class="bottom-nav">
    <div class="nav-item active" onclick="tab('home', this)">
        <i class="fas fa-home"></i>
        <span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
    </div>
    <div class="nav-item" onclick="tab('market', this)">
        <i class="fas fa-store"></i>
        <span>Ø§Ù„Ø³ÙˆÙ‚</span>
    </div>
    <div class="nav-item" onclick="tab('assets', this)">
        <i class="fas fa-cow"></i>
        <span>Ø£ØµÙˆÙ„ÙŠ</span>
    </div>
    <div class="nav-item" onclick="tab('community', this)">
        <i class="fas fa-comment-dots"></i>
        <span>Ø§Ù„Ø¯Ø¹Ù…</span>
    </div>
    <div class="nav-item" onclick="tab('wallet', this)">
        <i class="fas fa-wallet"></i>
        <span>Ø§Ù„Ù…Ø­ÙØ¸Ø©</span>
    </div>
</nav>

<script>
    // --- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙˆÙ‡Ù…ÙŠØ© (ÙŠØªÙ… Ù…Ø²Ø§Ù…Ù†ØªÙ‡Ø§ Ù…Ø¹ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…) ---
    let userData = {
        name: "Ø²Ø§Ø¦Ø±",
        balance: parseFloat(localStorage.getItem('user_balance_101')) || 100000,
        shares: JSON.parse(localStorage.getItem('user_shares_101')) || []
    };

    // --- Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª ---
    function tab(pageId, el) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById(pageId).classList.add('active');
        
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        if(el) el.classList.add('active');
        else {
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´ÙƒÙ„ Ø¥Ø°Ø§ ØªÙ… Ø§Ù„Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ù…Ù† Ø²Ø± Ø®Ø§Ø±Ø¬ÙŠ
            document.querySelectorAll('.nav-item').forEach(n => {
                if(n.innerText.trim() === pageId) n.classList.add('active');
            });
        }
    }

    // --- Ù…Ø²Ø§Ù…Ù†Ø© ÙˆØ¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ---
    function syncUI() {
        document.getElementById('wallet-display').innerText = userData.balance.toLocaleString();
        document.getElementById('wallet-large').innerText = userData.balance.toLocaleString();
        document.getElementById('assets-count').innerText = userData.shares.length;
        
        // Ø­Ø³Ø§Ø¨ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£ØµÙˆÙ„
        let totalVal = userData.shares.reduce((acc, share) => acc + share.price, 0);
        document.getElementById('total-assets-val').innerText = totalVal.toLocaleString() + " Ù„.Ø³";

        renderMarket();
        renderMyAssets();
    }

    // --- Ø¹Ø±Ø¶ Ø§Ù„Ø³ÙˆÙ‚ (Ø§Ù„Ù…Ø±ØªØ¨Ø· Ø¨Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…) ---
    function renderMarket() {
        const marketGrid = document.getElementById('market-grid');
        const products = JSON.parse(localStorage.getItem('site_products')) || [];
        
        marketGrid.innerHTML = '';
        if(products.length === 0) {
            marketGrid.innerHTML = '<p style="text-align:center; color:#94a3b8;">Ø§Ù„Ø³ÙˆÙ‚ ÙØ§Ø±Øº Ø­Ø§Ù„ÙŠØ§Ù‹</p>';
            return;
        }

        products.forEach(p => {
            marketGrid.innerHTML += `
                <div class="market-item">
                    <span class="badge">Ø¹Ø§Ø¦Ø¯ ${p.returnRate}%</span>
                    <div class="market-info">
                        <h4>${p.name}</h4>
                        <div class="market-price">${p.price.toLocaleString()} <span>Ù„.Ø³ / Ø³Ù‡Ù…</span></div>
                    </div>
                    <button class="btn-buy" onclick="buyAsset('${p.name}', ${p.price})">Ø§Ø³ØªØ«Ù…Ø§Ø± Ø§Ù„Ø¢Ù†</button>
                </div>
            `;
        });
    }

    // --- Ø´Ø±Ø§Ø¡ Ø³Ù‡Ù… ---
    function buyAsset(name, price) {
        if(userData.balance >= price) {
            userData.balance -= price;
            userData.shares.push({ name, price, date: new Date().toLocaleDateString() });
            
            saveData();
            showToast(`Ù…Ø¨Ø±ÙˆÙƒ! Ø§Ø´ØªØ±ÙŠØª Ø³Ù‡Ù… ÙÙŠ ${name}`);
            syncUI();
        } else {
            showToast('Ø§Ù„Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø´Ø­Ù† Ø£ÙˆÙ„Ø§Ù‹', 'error');
        }
    }

    // --- Ø¹Ø±Ø¶ Ø£ØµÙˆÙ„ÙŠ ---
    function renderMyAssets() {
        const list = document.getElementById('my-assets-list');
        if(userData.shares.length === 0) return;

        list.innerHTML = '';
        userData.shares.forEach(s => {
            list.innerHTML += `
                <div class="market-item" style="border-right: 5px solid var(--primary)">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <div>
                            <h4>${s.name}</h4>
                            <small style="color:#94a3b8">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø´Ø±Ø§Ø¡: ${s.date}</small>
                        </div>
                        <div style="text-align:left">
                            <div style="color:var(--primary); font-weight:bold;">Ù†Ø´Ø·</div>
                            <div style="font-size:0.8rem; color:#64748b">${s.price.toLocaleString()} Ù„.Ø³</div>
                        </div>
                    </div>
                </div>
            `;
        });
    }

    // --- Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© ---
    function handleFinance(type) {
        const amt = parseFloat(document.getElementById('amount-input').value);
        if(!amt || amt <= 0) return showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­');

        if(type === 'withdraw' && amt > userData.balance) return showToast('Ø±ØµÙŠØ¯Ùƒ Ù„Ø§ ÙŠØ³Ù…Ø­ Ø¨Ø³Ø­Ø¨ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¨Ù„Øº');

        // ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø­Ù‚ÙŠÙ‚ÙŠ Ù†Ø±Ø³Ù„ Ø§Ù„Ø·Ù„Ø¨ Ù„Ù„Ø³ÙŠØ±ÙØ±ØŒ Ù‡Ù†Ø§ Ø³Ù†Ø®Ø²Ù†Ù‡Ø§ Ù„Ø±Ø§Ù‡Ø§ Ø§Ù„Ø£Ø¯Ù…Ù†
        let requests = JSON.parse(localStorage.getItem('site_withdrawals')) || [];
        requests.push({
            id: Date.now(),
            name: "Ù…Ø³ØªØ®Ø¯Ù… 101",
            amount: amt,
            type: type,
            date: new Date().toLocaleString()
        });
        localStorage.setItem('site_withdrawals', JSON.stringify(requests));
        
        showToast('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©');
        document.getElementById('amount-input').value = '';
    }

    // --- Ù…Ø³Ø§Ø¹Ø¯Ø§Øª ---
    function saveData() {
        localStorage.setItem('user_balance_101', userData.balance);
        localStorage.setItem('user_shares_101', JSON.stringify(userData.shares));
    }

    function showToast(msg) {
        const t = document.getElementById('toast');
        t.innerText = msg;
        t.style.display = 'block';
        setTimeout(() => t.style.display = 'none', 3000);
    }

    function sendMessage() {
        const inp = document.getElementById('chat-in');
        if(!inp.value) return;
        const box = document.getElementById('chat-box');
        box.innerHTML += `
            <div style="background: var(--primary); color:white; padding:12px; border-radius:15px; margin-bottom:10px; align-self:flex-end; margin-right:40px; font-size:0.9rem;">
                ${inp.value}
            </div>
        `;
        inp.value = '';
        box.scrollTop = box.scrollHeight;
    }

    window.onload = syncUI;
</script>

</body>
</html>